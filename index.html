<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wedding Seating Planner</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@400;600;700&family=Dancing+Script:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      :root {
        /* Elegant wedding color palette */
        --primary-color: #d4a5a5; /* Soft pink */
        --secondary-color: #f2e6e6; /* Light pink */
        --accent-color: #f9f2f2; /* Very light pink */
        --tertiary-color: #e6d7d7; /* Muted pink */
        --beige-color: #f5f0e6; /* Soft beige */
        --text-color: #6d4c41; /* Warm brown */
        --light-text: #8d6e63; /* Lighter warm brown */
        --background-color: #fdfaf7; /* Creamy background */
        --card-background: #ffffff;
        --border-color: #f2e6e6;
        --success-color: #a5d6a7;
        --error-color: #ef9a9a;
        --warning-color: #ffcc80;
        --shadow-light: 0 2px 4px rgba(212, 165, 165, 0.1);
        --shadow-medium: 0 4px 8px rgba(212, 165, 165, 0.15);
        --shadow-heavy: 0 8px 16px rgba(212, 165, 165, 0.2);
      }
      body {
        font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, sans-serif;
        background-color: var(--background-color);
        margin: 0;
        padding: 15px;
        color: var(--text-color);
        line-height: 1.6;
        background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23f2e6e6' fill-opacity='0.3' fill-rule='evenodd'/%3E%3C/svg%3E");
      }
      h1 {
        text-align: center;
        color: var(--text-color);
        font-family: "Dancing Script", cursive;
        font-weight: 700;
        margin-bottom: 30px;
        font-size: 42px;
        position: relative;
        padding-bottom: 15px;
      }
      h1::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 120px;
        height: 3px;
        background: linear-gradient(
          90deg,
          transparent,
          var(--primary-color),
          transparent
        );
      }
      .main-container {
        display: flex;
        gap: 30px;
        max-width: 1400px;
        margin: 0 auto;
      }
      .left-panel {
        width: 340px;
      }
      .panel {
        background-color: var(--card-background);
        border-radius: 12px;
        padding: 25px;
        box-shadow: var(--shadow-light);
        margin-bottom: 25px;
        border: 1px solid var(--border-color);
        position: relative;
        overflow: hidden;
      }
      .panel::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 5px;
        background: linear-gradient(
          90deg,
          var(--primary-color),
          var(--secondary-color)
        );
      }
      .form-group {
        margin-bottom: 18px;
      }
      label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: var(--light-text);
        font-size: 14px;
      }
      input,
      select,
      button {
        width: 100%;
        padding: 12px 14px;
        margin-top: 5px;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        font-size: 14px;
        font-family: "Inter", sans-serif;
        transition: all 0.3s ease;
        box-sizing: border-box;
      }
      input:focus,
      select:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(212, 165, 165, 0.2);
      }
      button {
        background-color: var(--primary-color);
        color: white;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
        margin-top: 12px;
        padding: 12px 14px;
        font-size: 14px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        border-radius: 8px;
      }
      button:hover {
        background-color: #c89292;
        transform: translateY(-2px);
        box-shadow: var(--shadow-medium);
      }
      button:active {
        transform: translateY(0);
      }
      .secondary-btn {
        background-color: var(--secondary-color);
        color: var(--primary-color);
      }
      .secondary-btn:hover {
        background-color: #e6d0d0;
      }
      button.active {
        background-color: var(--primary-color);
        color: white;
      }
      /* Guest Table Styling */
      .guest-table-container {
        overflow-x: auto;
        border-radius: 12px;
        border: 1px solid var(--border-color);
        background-color: var(--card-background);
        margin-bottom: 25px;
        box-shadow: var(--shadow-light);
        max-height: 400px;
        overflow-y: auto;
      }
      .guest-table {
        width: 100%;
        border-collapse: collapse;
      }
      .guest-table th {
        background-color: var(--accent-color);
        padding: 14px 18px;
        text-align: left;
        font-weight: 600;
        color: var(--light-text);
        border-bottom: 1px solid var(--border-color);
        font-size: 14px;
        position: sticky;
        top: 0;
        z-index: 10;
      }
      .guest-table td {
        padding: 14px 18px;
        border-bottom: 1px solid var(--border-color);
        font-size: 14px;
      }
      .guest-table tr:hover {
        background-color: var(--accent-color);
      }
      .guest-table tr:last-child td {
        border-bottom: none;
      }
      .status-badge {
        display: inline-block;
        padding: 4px 10px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 500;
        text-align: center;
      }
      .status-attending {
        background-color: rgba(165, 214, 167, 0.2);
        color: #2e7d32;
      }
      .status-pending {
        background-color: rgba(255, 204, 128, 0.2);
        color: #e65100;
      }
      .status-declined {
        background-color: rgba(239, 154, 154, 0.2);
        color: #c62828;
      }
      .side-badge {
        display: inline-block;
        padding: 4px 10px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 500;
      }
      .side-bride {
        background-color: rgba(255, 182, 193, 0.3);
        color: #d63384;
      }
      .side-groom {
        background-color: rgba(173, 216, 230, 0.3);
        color: #0d6efd;
      }
      .side-couple {
        background-color: rgba(204, 153, 255, 0.3);
        color: #6f42c1;
      }
      .side-other {
        background-color: rgba(211, 211, 211, 0.3);
        color: #6c757d;
      }
      /* View Toggle */
      .view-toggle {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
      }
      /* Guest List Styling */
      .guest-list-container {
        margin-top: 18px;
        border-radius: 12px;
        border: 1px solid var(--border-color);
        background-color: var(--card-background);
        overflow: hidden;
        box-shadow: var(--shadow-light);
      }
      .guest-list-header {
        background-color: var(--accent-color);
        padding: 12px 18px;
        font-weight: 600;
        color: var(--light-text);
        border-bottom: 1px solid var(--border-color);
        font-size: 14px;
      }
      .guest-list {
        max-height: 220px;
        overflow-y: auto;
        scrollbar-width: thin;
        scrollbar-color: var(--primary-color) var(--accent-color);
      }
      .guest-list::-webkit-scrollbar {
        width: 6px;
      }
      .guest-list::-webkit-scrollbar-track {
        background: var(--accent-color);
        border-radius: 3px;
      }
      .guest-list::-webkit-scrollbar-thumb {
        background-color: var(--primary-color);
        border-radius: 3px;
      }
      .guest-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 18px;
        border-bottom: 1px solid var(--border-color);
        transition: background-color 0.3s;
      }
      .guest-item:last-child {
        border-bottom: none;
      }
      .guest-item:hover {
        background-color: var(--accent-color);
      }
      .guest-name {
        flex: 1;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        font-size: 14px;
      }
      .guest-info {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-left: 10px;
      }
      .guest-side {
        font-size: 11px;
        padding: 3px 8px;
        border-radius: 20px;
        font-weight: 500;
      }
      .edit-guest,
      .delete-guest {
        background: none;
        border: none;
        color: var(--primary-color);
        cursor: pointer;
        font-size: 14px;
        padding: 0;
        width: 28px;
        height: 28px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: all 0.3s;
      }
      .edit-guest:hover,
      .delete-guest:hover {
        background-color: rgba(212, 165, 165, 0.1);
      }
      /* Edit Form */
      .edit-form {
        padding: 14px 18px;
        border-bottom: 1px solid var(--border-color);
        background-color: var(--accent-color);
      }
      .right-panel {
        flex: 1;
        padding-bottom: 25px;
      }
      .tables-container {
        display: flex;
        gap: 30px;
        flex-wrap: wrap;
        justify-content: center;
        padding-bottom: 15px;
      }
      /* Floor Plan Styles */
      .floor-plan {
        width: 100%;
        height: 600px;
        background-color: var(--accent-color);
        border-radius: 12px;
        position: relative;
        margin-bottom: 25px;
        overflow: hidden;
        box-shadow: var(--shadow-light);
      }
      .floor-plan-table {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background-color: var(--card-background);
        border: 1px solid var(--border-color);
        cursor: move;
        transition: all 0.3s ease;
        position: absolute;
        width: 120px;
        height: 120px;
        border-radius: 50%;
        user-select: none;
        box-shadow: var(--shadow-light);
      }
      .floor-plan-table:hover {
        box-shadow: var(--shadow-medium);
      }
      .floor-plan-table.dragging {
        opacity: 0.8;
        transform: scale(1.05);
        z-index: 1000;
        box-shadow: var(--shadow-heavy);
      }
      .floor-plan-table-name {
        font-family: "Inter", sans-serif;
        font-size: 12px;
        color: var(--text-color);
        text-align: center;
        margin-bottom: 5px;
        font-weight: 600;
      }
      .floor-plan-table-count {
        font-size: 10px;
        background-color: var(--primary-color);
        color: white;
        border-radius: 20px;
        padding: 2px 8px;
        font-weight: 500;
      }
      /* Table Card Styles - Round tables */
      .table-card {
        position: relative;
        width: 220px;
        height: 220px;
        border-radius: 50%;
        background-color: var(--card-background);
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
        flex-shrink: 0;
        box-shadow: var(--shadow-light);
        border: 1px solid var(--border-color);
        transition: all 0.3s ease;
        overflow: hidden;
      }
      .table-card:hover {
        box-shadow: var(--shadow-medium);
        transform: translateY(-5px);
      }
      .table-header {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        width: 100%;
        margin-bottom: 10px;
      }
      .table-card h3 {
        margin: 0;
        font-family: "Playfair Display", serif;
        font-size: 18px;
        color: var(--text-color);
        text-align: center;
        flex-grow: 1;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        font-weight: 600;
      }
      .guest-count {
        font-size: 12px;
        background-color: var(--secondary-color);
        color: var(--primary-color);
        border-radius: 20px;
        padding: 3px 10px;
        font-weight: 500;
        flex-shrink: 0;
        margin-top: 5px;
      }
      .floor-plan-delete-table {
        position: absolute;
        top: -5px;
        right: -5px;
        background: white;
        border: 1px solid var(--border-color);
        color: var(--light-text);
        cursor: pointer;
        font-size: 12px;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s;
        z-index: 20;
        box-shadow: var(--shadow-light);
      }
      .floor-plan-delete-table:hover {
        background: white;
        color: var(--error-color);
        transform: scale(1.1);
        box-shadow: var(--shadow-medium);
      }
      .table-card ul {
        list-style: none;
        padding: 0;
        margin: 0;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
        width: 100%;
        height: 100%;
        overflow: hidden;
        position: relative;
      }
      .table-card ul li {
        font-size: 10px;
        margin: 3px;
        padding: 8px;
        border-radius: 50%;
        text-align: center;
        cursor: grab;
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        flex-shrink: 0;
        position: relative;
        font-weight: 500;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .table-card ul li.bride {
        background-color: rgba(255, 182, 193, 0.4);
        color: #d63384;
      }
      .table-card ul li.groom {
        background-color: rgba(173, 216, 230, 0.4);
        color: #0d6efd;
      }
      .table-card ul li.other {
        background-color: rgba(211, 211, 211, 0.4);
        color: #6c757d;
      }
      .table-card ul li:hover {
        transform: scale(1.1);
        box-shadow: var(--shadow-medium);
        z-index: 5;
      }
      .table-card ul li:hover::after {
        content: attr(data-fullname) " | " attr(data-side) " | RSVP: "
          attr(data-rsvp);
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        background-color: var(--card-background);
        color: var(--text-color);
        padding: 8px 12px;
        border-radius: 8px;
        font-size: 11px;
        white-space: nowrap;
        box-shadow: var(--shadow-medium);
        z-index: 10;
        margin-bottom: 8px;
        border: 1px solid var(--border-color);
        max-width: 150px;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .empty-state {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 40px;
        color: var(--light-text);
        text-align: center;
      }
      .empty-state i {
        font-size: 48px;
        margin-bottom: 15px;
        opacity: 0.5;
      }
      .empty-state p {
        font-size: 16px;
        max-width: 200px;
        line-height: 1.4;
      }
      .fab {
        position: fixed;
        bottom: 30px;
        right: 30px;
        background-color: var(--primary-color);
        color: white;
        width: 56px;
        height: 56px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        cursor: pointer;
        box-shadow: var(--shadow-medium);
        transition: all 0.3s ease;
        z-index: 1000;
      }
      .fab:hover {
        background-color: #c89292;
        transform: scale(1.05);
      }
      .fab-menu {
        position: fixed;
        bottom: 90px;
        right: 30px;
        display: none;
        flex-direction: column;
        gap: 12px;
        z-index: 1000;
      }
      .fab-menu.show {
        display: flex;
        animation: slideUp 0.3s ease;
      }
      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .fab-menu button {
        background-color: white;
        border: 1px solid var(--border-color);
        padding: 12px 16px;
        border-radius: 8px;
        color: var(--text-color);
        font-size: 14px;
        width: 160px;
        box-shadow: var(--shadow-light);
        text-align: left;
        display: flex;
        align-items: center;
        gap: 10px;
        transition: all 0.3s ease;
      }
      .fab-menu button:hover {
        background-color: var(--accent-color);
        transform: translateX(-5px);
      }
      .fab-menu button i {
        color: var(--primary-color);
        font-size: 16px;
      }
      .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        background-color: white;
        color: var(--text-color);
        padding: 16px 20px;
        border-radius: 12px;
        box-shadow: var(--shadow-medium);
        border-left: 4px solid var(--primary-color);
        z-index: 2000;
        display: flex;
        align-items: center;
        gap: 12px;
        transform: translateX(120%);
        transition: transform 0.3s ease;
      }
      .notification.show {
        transform: translateX(0);
      }
      .notification i {
        color: var(--primary-color);
        font-size: 18px;
      }
      .notification.success {
        border-left-color: var(--success-color);
      }
      .notification.success i {
        color: var(--success-color);
      }
      .notification.error {
        border-left-color: var(--error-color);
      }
      .notification.error i {
        color: var(--error-color);
      }
      /* Trash Area Styling */
      .trash-area {
        position: fixed;
        bottom: 30px;
        left: 30px;
        width: 60px;
        height: 60px;
        background-color: var(--error-color);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: var(--shadow-medium);
        transition: all 0.3s ease;
        z-index: 999;
        opacity: 0.8;
      }
      .trash-area.active {
        background-color: #d63447;
        transform: scale(1.1);
        opacity: 1;
      }
      .trash-area i {
        font-size: 24px;
        color: white;
      }
      .trash-area span {
        position: absolute;
        bottom: -25px;
        background-color: #721c24;
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        white-space: nowrap;
        opacity: 0;
        transition: opacity 0.3s;
      }
      .trash-area:hover span {
        opacity: 1;
      }
      /* Floor Plan Instructions */
      .floor-plan-instructions {
        position: absolute;
        top: 15px;
        left: 15px;
        background-color: rgba(255, 255, 255, 0.9);
        padding: 10px 15px;
        border-radius: 8px;
        font-size: 13px;
        color: var(--light-text);
        z-index: 100;
        box-shadow: var(--shadow-light);
        display: flex;
        align-items: center;
        gap: 8px;
      }
      /* Action buttons styling */
      .action-buttons {
        display: flex;
        gap: 5px;
      }
      .action-buttons button {
        width: auto;
        margin: 0;
        padding: 8px 10px;
        font-size: 12px;
      }
      @media (max-width: 900px) {
        .main-container {
          flex-direction: column;
          gap: 25px;
        }
        .left-panel {
          width: 100%;
        }
      }
      @media (max-width: 600px) {
        h1 {
          font-size: 32px;
        }
        .table-card {
          width: 180px;
          height: 180px;
          padding: 15px;
        }
        .table-card ul li {
          font-size: 9px;
          width: 30px;
          height: 30px;
          padding: 6px;
        }
        input,
        select,
        button {
          font-size: 14px;
          padding: 10px;
        }
        .fab-menu button {
          width: 150px;
          font-size: 13px;
        }
        .trash-area {
          width: 50px;
          height: 50px;
          bottom: 15px;
          left: 15px;
        }
        .trash-area i {
          font-size: 20px;
        }
        .floor-plan {
          height: 400px;
        }
        .guest-table-container {
          font-size: 12px;
        }
        .guest-table th,
        .guest-table td {
          padding: 10px 12px;
        }
        .floor-plan-instructions {
          font-size: 11px;
          padding: 6px 10px;
        }
        .action-buttons {
          flex-direction: column;
          gap: 2px;
        }
        .action-buttons button {
          padding: 4px 6px;
          font-size: 10px;
        }
      }
    </style>
  </head>
  <body>
    <h1>Wedding Seating Planner</h1>
    <div class="main-container">
      <div class="left-panel">
        <div class="panel">
          <h2
            style="
              margin-top: 0;
              color: var(--text-color);
              font-size: 22px;
              font-weight: 600;
              font-family: 'Playfair Display', serif;
            "
          >
            Add Guest
          </h2>
          <div class="form-group">
            <label for="guestName">Guest Name</label>
            <input type="text" id="guestName" placeholder="Enter guest name" />
          </div>
          <div class="form-group">
            <label for="guestSide">Side</label>
            <select id="guestSide">
              <option value="Bride">Bride</option>
              <option value="Groom">Groom</option>
              <option value="Couple">Couple</option>
              <option value="Other">Other</option>
            </select>
          </div>
          <div class="form-group">
            <label for="guestRSVP">RSVP Status</label>
            <select id="guestRSVP">
              <option value="Attending">Attending</option>
              <option value="Declined">Declined</option>
              <option value="Pending">Pending</option>
            </select>
          </div>
          <div class="form-group">
            <label for="invitationSent">Invitation Sent</label>
            <select id="invitationSent">
              <option value="Yes">Yes</option>
              <option value="No">No</option>
            </select>
          </div>
          <div class="form-group">
            <label for="saveTheDate">Save The Date Sent</label>
            <select id="saveTheDate">
              <option value="Yes">Yes</option>
              <option value="No">No</option>
            </select>
          </div>
          <button id="addGuest">
            <i class="fas fa-user-plus"></i> Add Guest
          </button>
          <h2
            style="
              margin-top: 30px;
              color: var(--text-color);
              font-size: 22px;
              font-weight: 600;
              font-family: 'Playfair Display', serif;
            "
          >
            Unassigned Guests
          </h2>
          <div class="guest-list-container">
            <div class="guest-list-header">Drag guests to tables</div>
            <div
              class="form-group"
              style="margin-top: 12px; margin-bottom: 0; padding: 0 18px"
            >
              <div style="position: relative">
                <input
                  type="text"
                  id="searchGuests"
                  placeholder="Search guests..."
                  style="padding-left: 38px"
                />
                <i
                  class="fas fa-search"
                  style="
                    position: absolute;
                    left: 18px;
                    top: 50%;
                    transform: translateY(-50%);
                    color: var(--primary-color);
                  "
                ></i>
              </div>
            </div>
            <div class="guest-list" id="guestList">
              <div id="emptyGuestList" class="empty-state">
                <i class="fas fa-users"></i>
                <p>No guests added yet</p>
              </div>
            </div>
          </div>
          <h2
            style="
              margin-top: 30px;
              color: var(--text-color);
              font-size: 22px;
              font-weight: 600;
              font-family: 'Playfair Display', serif;
            "
          >
            Add Table
          </h2>
          <div class="form-group">
            <label for="tableNameInput">Table Name (optional)</label>
            <input
              type="text"
              id="tableNameInput"
              placeholder="e.g. Family Table"
            />
          </div>
          <button id="addTable">
            <i class="fas fa-plus-circle"></i> Add Table
          </button>
          <div
            style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 18px"
          >
            <button id="exportPDF" class="secondary-btn">
              <i class="fas fa-file-pdf"></i> Export PDF
            </button>
            <button id="generatePlaceCards" class="secondary-btn">
              <i class="fas fa-id-card"></i> Place Cards
            </button>
            <button id="resetAll" class="secondary-btn">
              <i class="fas fa-redo"></i> Reset All
            </button>
          </div>
        </div>
      </div>
      <div class="right-panel">
        <!-- Guest List Table -->
        <div class="guest-table-container">
          <div
            class="guest-list-header"
            style="
              padding: 18px;
              font-size: 20px;
              font-weight: 600;
              font-family: 'Playfair Display', serif;
            "
          >
            <i class="fas fa-users"></i> Guest List
          </div>
          <table class="guest-table">
            <thead>
              <tr>
                <th>Guest Name</th>
                <th>Side</th>
                <th>RSVP</th>
                <th>Invitation</th>
                <th>Save the Date</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="guestTableBody">
              <tr id="emptyGuestRow">
                <td
                  colspan="6"
                  style="
                    text-align: center;
                    padding: 25px;
                    color: var(--light-text);
                  "
                >
                  <i class="fas fa-users"></i><br />No guests added yet
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <!-- Seating Arrangement Section -->
        <div class="panel">
          <h2
            style="
              margin-top: 0;
              color: var(--text-color);
              font-size: 22px;
              font-weight: 600;
              font-family: 'Playfair Display', serif;
            "
          >
            Seating Arrangement
          </h2>
          <!-- View Toggle -->
          <div class="view-toggle">
            <button id="tableView" class="secondary-btn active">
              <i class="fas fa-th"></i> Table View
            </button>
            <button id="floorPlanView" class="secondary-btn">
              <i class="fas fa-map"></i> Floor Plan
            </button>
          </div>
          <div class="tables-container" id="tablesContainer">
            <div id="emptyTables" class="empty-state" style="width: 100%">
              <i class="fas fa-chair"></i>
              <p>No tables created yet. Add your first table to get started!</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Trash Area -->
    <div class="trash-area" id="trashArea">
      <i class="fas fa-trash-alt"></i>
      <span>Drop here to delete</span>
    </div>
    <div class="fab" id="fab">
      <i class="fas fa-plus"></i>
    </div>
    <div class="fab-menu" id="fabMenu">
      <button onclick="document.getElementById('addGuest').click()">
        <i class="fas fa-user-plus"></i> Add Guest
      </button>
      <button onclick="document.getElementById('addTable').click()">
        <i class="fas fa-plus-circle"></i> Add Table
      </button>
      <button onclick="document.getElementById('exportPDF').click()">
        <i class="fas fa-file-pdf"></i> Export PDF
      </button>
      <button onclick="document.getElementById('generatePlaceCards').click()">
        <i class="fas fa-id-card"></i> Place Cards
      </button>
    </div>
    <div class="notification" id="notification">
      <i class="fas fa-check-circle"></i>
      <span id="notificationText">Notification text</span>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
      // Initialize data from localStorage or set defaults
      let weddingData = {
        guests: [],
        tables: [],
        tablePositions: {},
      };
      // Load data from localStorage if available
      function loadData() {
        try {
          const savedData = localStorage.getItem("weddingSeatingData");
          if (savedData) {
            weddingData = JSON.parse(savedData);
            console.log("Data loaded from localStorage:", weddingData);
            renderData();
          } else {
            console.log("No saved data found, using defaults");
          }
        } catch (error) {
          console.error("Error loading data from localStorage:", error);
        }
      }
      // Save data to localStorage
      function saveData() {
        try {
          localStorage.setItem(
            "weddingSeatingData",
            JSON.stringify(weddingData)
          );
          console.log("Data saved to localStorage:", weddingData);
        } catch (error) {
          console.error("Error saving data to localStorage:", error);
          showNotification(
            "Error saving data. Your browser may not support local storage.",
            "error"
          );
        }
      }
      // Function to renumber tables after deletion
      function renumberTables() {
        // Find all auto-named tables (pattern: "Table X")
        const autoNamedTables = weddingData.tables.filter((table) =>
          /^Table \d+$/.test(table.name)
        );
        // Sort by the number in the name
        autoNamedTables.sort((a, b) => {
          const numA = parseInt(a.name.split(" ")[1]);
          const numB = parseInt(b.name.split(" ")[1]);
          return numA - numB;
        });
        // Renumber starting from 1
        autoNamedTables.forEach((table, index) => {
          const oldName = table.name;
          const newName = `Table ${index + 1}`;
          // Update the table name in the data model
          table.name = newName;
          // Update table positions if they exist
          if (weddingData.tablePositions[oldName]) {
            weddingData.tablePositions[newName] =
              weddingData.tablePositions[oldName];
            delete weddingData.tablePositions[oldName];
          }
          // Update DOM in table view if it exists
          const tableElement = tables.find(
            (t) =>
              t.querySelector("h3") &&
              t.querySelector("h3").textContent === oldName
          );
          if (tableElement) {
            tableElement.querySelector("h3").textContent = newName;
          }
          // Update DOM in floor plan view if it exists
          const floorPlanTable = document.querySelector(
            `.floor-plan-table[data-table-name="${oldName}"]`
          );
          if (floorPlanTable) {
            floorPlanTable.dataset.tableName = newName;
            floorPlanTable.querySelector(".floor-plan-table-name").textContent =
              newName;
          }
        });
        // Save the updated data
        saveData();
      }
      // Function to calculate position for new table in floor plan
      function calculateNewTablePosition() {
        // Grid layout for initial positioning
        const cols = 4;
        const tableWidth = 140; // Including margin
        const tableHeight = 140; // Including margin
        const startX = 50;
        const startY = 100;
        // Count existing tables
        const existingTables = weddingData.tables.length;
        // Calculate position in grid
        const row = Math.floor(existingTables / cols);
        const col = existingTables % cols;
        return {
          left: startX + col * tableWidth,
          top: startY + row * tableHeight,
        };
      }
      // Render loaded data
      function renderData() {
        console.log("Rendering data...");
        // Clear existing data
        guestList.innerHTML = "";
        guestTableBody.innerHTML = "";
        tablesContainer.innerHTML = "";
        tables = [];
        // Add empty states
        guestList.appendChild(emptyGuestList);
        guestTableBody.appendChild(emptyGuestRow);
        tablesContainer.appendChild(emptyTables);
        // Render guests
        if (weddingData.guests && weddingData.guests.length > 0) {
          console.log("Rendering guests:", weddingData.guests.length);
          emptyGuestList.style.display = "none";
          emptyGuestRow.style.display = "none";
          weddingData.guests.forEach((guest) => {
            // Add to guest list
            const guestItem = document.createElement("div");
            guestItem.className = "guest-item";
            guestItem.draggable = true;
            guestItem.dataset.name = guest.name;
            guestItem.dataset.side = guest.side;
            guestItem.dataset.rsvp = guest.rsvp;
            guestItem.innerHTML = `
              <div class="guest-name">${guest.name}</div>
              <div class="guest-info">
                <span class="guest-side ${guest.side.toLowerCase()}">${
              guest.side
            }</span>
                <button class="edit-guest" data-name="${guest.name}">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="delete-guest" data-name="${guest.name}">
                  <i class="fas fa-times"></i>
                </button>
              </div>
            `;
            guestItem.addEventListener("dragstart", (e) => {
              e.dataTransfer.setData(
                "text/plain",
                JSON.stringify({
                  name: guest.name,
                  side: guest.side,
                  rsvp: guest.rsvp,
                })
              );
              trashArea.classList.add("active");
            });
            guestItem.addEventListener("dragend", () => {
              trashArea.classList.remove("active");
            });
            guestList.appendChild(guestItem);
            // Add to guest table
            addGuestToTable(
              guest.name,
              guest.side,
              guest.rsvp,
              guest.invitationSent,
              guest.saveTheDate
            );
          });
        }
        // Render tables
        if (weddingData.tables && weddingData.tables.length > 0) {
          console.log("Rendering tables:", weddingData.tables.length);
          emptyTables.style.display = "none";
          weddingData.tables.forEach((table, index) => {
            createTable(index + 1, table.name, false);
            // Add guests to table
            const tableElement = tables[tables.length - 1];
            const ul = tableElement.querySelector("ul");
            if (table.guests && table.guests.length > 0) {
              table.guests.forEach((guestName) => {
                // Find guest data
                const guestData = weddingData.guests.find(
                  (g) => g.name === guestName
                );
                if (guestData) {
                  // Create guest element
                  const li = document.createElement("li");
                  // Truncate long names to fit in circle
                  const displayName =
                    guestData.name.length > 6
                      ? guestData.name.substring(0, 5) + "..."
                      : guestData.name;
                  li.textContent = displayName;
                  li.draggable = true;
                  li.dataset.name = guestData.name;
                  li.dataset.fullname = guestData.name;
                  li.dataset.side = guestData.side;
                  li.dataset.rsvp = guestData.rsvp;
                  li.classList.add(
                    guestData.side === "Bride"
                      ? "bride"
                      : guestData.side === "Groom"
                      ? "groom"
                      : "other"
                  );
                  li.addEventListener("dragstart", (ev) => {
                    ev.dataTransfer.setData(
                      "text/plain",
                      JSON.stringify(guestData)
                    );
                    trashArea.classList.add("active");
                  });
                  li.addEventListener("dragend", () => {
                    trashArea.classList.remove("active");
                  });
                  ul.appendChild(li);
                }
              });
            }
            updateGuestCount();
          });
        }
        // Update table positions
        tablePositions = weddingData.tablePositions || {};
      }
      const tablesContainer = document.getElementById("tablesContainer");
      const addTableBtn = document.getElementById("addTable");
      const addGuestBtn = document.getElementById("addGuest");
      const guestNameInput = document.getElementById("guestName");
      const guestList = document.getElementById("guestList");
      const guestTableBody = document.getElementById("guestTableBody");
      const exportPDFBtn = document.getElementById("exportPDF");
      const generatePlaceCardsBtn =
        document.getElementById("generatePlaceCards");
      const resetAllBtn = document.getElementById("resetAll");
      const tableNameInput = document.getElementById("tableNameInput");
      const guestSideInput = document.getElementById("guestSide");
      const guestRSVPInput = document.getElementById("guestRSVP");
      const invitationSentInput = document.getElementById("invitationSent");
      const saveTheDateInput = document.getElementById("saveTheDate");
      const fab = document.getElementById("fab");
      const fabMenu = document.getElementById("fabMenu");
      const emptyGuestList = document.getElementById("emptyGuestList");
      const emptyGuestRow = document.getElementById("emptyGuestRow");
      const emptyTables = document.getElementById("emptyTables");
      const notification = document.getElementById("notification");
      const notificationText = document.getElementById("notificationText");
      const trashArea = document.getElementById("trashArea");
      const searchGuestsInput = document.getElementById("searchGuests");
      const tableViewBtn = document.getElementById("tableView");
      const floorPlanViewBtn = document.getElementById("floorPlanView");
      let tables = [];
      let currentView = "table";
      let tablePositions = {};
      // Load data when page loads
      document.addEventListener("DOMContentLoaded", loadData);
      // Show notification
      function showNotification(message, type = "success") {
        notificationText.textContent = message;
        notification.className = "notification show";
        if (type === "success") {
          notification.classList.add("success");
          notification.querySelector("i").className = "fas fa-check-circle";
        } else if (type === "error") {
          notification.classList.add("error");
          notification.querySelector("i").className =
            "fas fa-exclamation-circle";
        }
        setTimeout(() => {
          notification.classList.remove("show");
        }, 3000);
      }
      // Toggle FAB menu
      fab.addEventListener("click", () => {
        fabMenu.classList.toggle("show");
        fab.querySelector("i").classList.toggle("fa-plus");
        fab.querySelector("i").classList.toggle("fa-times");
      });
      // Check if guest exists anywhere
      function guestExistsAnywhere(name) {
        const inPool = [...guestList.querySelectorAll(".guest-item")].some(
          (item) => item.dataset.name === name
        );
        const inTable = [...guestTableBody.querySelectorAll(".guest-row")].some(
          (row) => row.dataset.name === name
        );
        const inTables = [...document.querySelectorAll(".table-card")].some(
          (tbl) => {
            return [...tbl.querySelectorAll("li")].some(
              (li) => li.dataset.name === name
            );
          }
        );
        return inPool || inTable || inTables;
      }
      // Add guest function
      function addGuest() {
        const name = guestNameInput.value.trim();
        if (!name) {
          showNotification("Please enter a guest name", "error");
          return;
        }
        if (guestExistsAnywhere(name)) {
          showNotification("Guest already exists!", "error");
          return;
        }
        const side = guestSideInput.value;
        const rsvp = guestRSVPInput.value;
        const invitationSent = invitationSentInput.value;
        const saveTheDate = saveTheDateInput.value;
        // Add to data model
        const guest = {
          name,
          side,
          rsvp,
          invitationSent,
          saveTheDate,
        };
        weddingData.guests.push(guest);
        saveData();
        // Add to table view
        addGuestToTable(name, side, rsvp, invitationSent, saveTheDate);
        // Add to guest list for seating plan
        const guestItem = document.createElement("div");
        guestItem.className = "guest-item";
        guestItem.draggable = true;
        guestItem.dataset.name = name;
        guestItem.dataset.side = side;
        guestItem.dataset.rsvp = rsvp;
        guestItem.innerHTML = `
          <div class="guest-name">${name}</div>
          <div class="guest-info">
            <span class="guest-side ${side.toLowerCase()}">${side}</span>
            <button class="edit-guest" data-name="${name}">
              <i class="fas fa-edit"></i>
            </button>
            <button class="delete-guest" data-name="${name}">
              <i class="fas fa-times"></i>
            </button>
          </div>
        `;
        guestItem.addEventListener("dragstart", (e) => {
          e.dataTransfer.setData(
            "text/plain",
            JSON.stringify({ name, side, rsvp })
          );
          trashArea.classList.add("active");
        });
        guestItem.addEventListener("dragend", () => {
          trashArea.classList.remove("active");
        });
        // Remove empty state if visible
        if (emptyGuestList) {
          emptyGuestList.style.display = "none";
        }
        guestList.appendChild(guestItem);
        // Clear form
        guestNameInput.value = "";
        showNotification(`Guest "${name}" added successfully`);
      }
      // Add guest to table view
      function addGuestToTable(name, side, rsvp, invitationSent, saveTheDate) {
        // Remove empty state if visible
        if (emptyGuestRow) {
          emptyGuestRow.style.display = "none";
        }
        const row = document.createElement("tr");
        row.className = "guest-row";
        row.dataset.name = name;
        row.dataset.side = side;
        row.dataset.rsvp = rsvp;
        row.dataset.invitation = invitationSent;
        row.dataset.savethedate = saveTheDate;
        const sideClass = side.toLowerCase();
        const rsvpClass = rsvp.toLowerCase();
        row.innerHTML = `
          <td>${name}</td>
          <td><span class="side-badge side-${sideClass}">${side}</span></td>
          <td><span class="status-badge status-${rsvpClass}">${rsvp}</span></td>
          <td>${invitationSent}</td>
          <td>${saveTheDate}</td>
          <td>
            <div class="action-buttons">
              <button class="edit-guest" data-name="${name}">
                <i class="fas fa-edit"></i>
              </button>
              <button class="delete-guest" data-name="${name}">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        `;
        guestTableBody.appendChild(row);
      }
      // Edit guest function
      function editGuest(guestElement, isTable = false) {
        const name = guestElement.dataset.name;
        const side = guestElement.dataset.side;
        const rsvp = guestElement.dataset.rsvp;
        const invitation = guestElement.dataset.invitation || "No";
        const saveTheDate = guestElement.dataset.savethedate || "No";
        // Create edit form
        const editForm = document.createElement("div");
        editForm.className = "edit-form";
        editForm.innerHTML = `
          <div class="form-group" style="margin-bottom: 12px;">
            <label>Guest Name</label>
            <input type="text" id="editGuestName" value="${name}">
          </div>
          <div class="form-group" style="margin-bottom: 12px;">
            <label>Side</label>
            <select id="editGuestSide">
              <option value="Bride" ${
                side === "Bride" ? "selected" : ""
              }>Bride</option>
              <option value="Groom" ${
                side === "Groom" ? "selected" : ""
              }>Groom</option>
              <option value="Couple" ${
                side === "Couple" ? "selected" : ""
              }>Couple</option>
              <option value="Other" ${
                side === "Other" ? "selected" : ""
              }>Other</option>
            </select>
          </div>
          <div class="form-group" style="margin-bottom: 12px;">
            <label>RSVP Status</label>
            <select id="editGuestRSVP">
              <option value="Attending" ${
                rsvp === "Attending" ? "selected" : ""
              }>Attending</option>
              <option value="Declined" ${
                rsvp === "Declined" ? "selected" : ""
              }>Declined</option>
              <option value="Pending" ${
                rsvp === "Pending" ? "selected" : ""
              }>Pending</option>
            </select>
          </div>
          <div class="form-group" style="margin-bottom: 12px;">
            <label>Invitation Sent</label>
            <select id="editInvitationSent">
              <option value="Yes" ${
                invitation === "Yes" ? "selected" : ""
              }>Yes</option>
              <option value="No" ${
                invitation === "No" ? "selected" : ""
              }>No</option>
            </select>
          </div>
          <div class="form-group" style="margin-bottom: 12px;">
            <label>Save The Date Sent</label>
            <select id="editSaveTheDate">
              <option value="Yes" ${
                saveTheDate === "Yes" ? "selected" : ""
              }>Yes</option>
              <option value="No" ${
                saveTheDate === "No" ? "selected" : ""
              }>No</option>
            </select>
          </div>
          <div style="display: flex; gap: 10px;">
            <button id="saveGuestEdit"><i class="fas fa-save"></i> Save</button>
            <button id="cancelGuestEdit" class="secondary-btn"><i class="fas fa-times"></i> Cancel</button>
          </div>
        `;
        // Replace the guest element with the form
        if (isTable) {
          const newRow = document.createElement("tr");
          newRow.appendChild(editForm);
          guestElement.parentNode.replaceChild(newRow, guestElement);
          // Handle save
          document
            .getElementById("saveGuestEdit")
            .addEventListener("click", () => {
              const newName = document
                .getElementById("editGuestName")
                .value.trim();
              const newSide = document.getElementById("editGuestSide").value;
              const newRSVP = document.getElementById("editGuestRSVP").value;
              const newInvitation =
                document.getElementById("editInvitationSent").value;
              const newSaveTheDate =
                document.getElementById("editSaveTheDate").value;
              if (!newName) {
                showNotification("Guest name cannot be empty", "error");
                return;
              }
              // Check if new name already exists (if name changed)
              if (newName !== name && guestExistsAnywhere(newName)) {
                showNotification(
                  "Guest with this name already exists!",
                  "error"
                );
                return;
              }
              // Update data model
              const guestIndex = weddingData.guests.findIndex(
                (g) => g.name === name
              );
              if (guestIndex !== -1) {
                weddingData.guests[guestIndex] = {
                  name: newName,
                  side: newSide,
                  rsvp: newRSVP,
                  invitationSent: newInvitation,
                  saveTheDate: newSaveTheDate,
                };
                saveData();
              }
              // Update the guest element with new values
              guestElement.dataset.name = newName;
              guestElement.dataset.side = newSide;
              guestElement.dataset.rsvp = newRSVP;
              guestElement.dataset.invitation = newInvitation;
              guestElement.dataset.savethedate = newSaveTheDate;
              const sideClass = newSide.toLowerCase();
              const rsvpClass = newRSVP.toLowerCase();
              guestElement.innerHTML = `
              <td>${newName}</td>
              <td><span class="side-badge side-${sideClass}">${newSide}</span></td>
              <td><span class="status-badge status-${rsvpClass}">${newRSVP}</span></td>
              <td>${newInvitation}</td>
              <td>${newSaveTheDate}</td>
              <td>
                <div class="action-buttons">
                  <button class="edit-guest" data-name="${newName}">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="delete-guest" data-name="${newName}">
                    <i class="fas fa-trash"></i>
                  </button>
                </div>
              </td>
            `;
              // Replace form with updated guest element
              newRow.parentNode.replaceChild(guestElement, newRow);
              // Update guest in the guest list if it exists
              const guestListItem = guestList.querySelector(
                `.guest-item[data-name="${name}"]`
              );
              if (guestListItem) {
                guestListItem.dataset.name = newName;
                guestListItem.dataset.side = newSide;
                guestListItem.dataset.rsvp = newRSVP;
                guestListItem.querySelector(".guest-name").textContent =
                  newName;
                guestListItem.querySelector(".guest-side").textContent =
                  newSide;
                guestListItem.querySelector(
                  ".guest-side"
                ).className = `guest-side ${newSide.toLowerCase()}`;
                guestListItem.querySelector(".edit-guest").dataset.name =
                  newName;
                guestListItem.querySelector(".delete-guest").dataset.name =
                  newName;
              }
              showNotification(`Guest "${newName}" updated successfully`);
            });
          // Handle cancel
          document
            .getElementById("cancelGuestEdit")
            .addEventListener("click", () => {
              newRow.parentNode.replaceChild(guestElement, newRow);
            });
        } else {
          guestElement.parentNode.replaceChild(editForm, guestElement);
          // Handle save
          document
            .getElementById("saveGuestEdit")
            .addEventListener("click", () => {
              const newName = document
                .getElementById("editGuestName")
                .value.trim();
              const newSide = document.getElementById("editGuestSide").value;
              const newRSVP = document.getElementById("editGuestRSVP").value;
              const newInvitation =
                document.getElementById("editInvitationSent").value;
              const newSaveTheDate =
                document.getElementById("editSaveTheDate").value;
              if (!newName) {
                showNotification("Guest name cannot be empty", "error");
                return;
              }
              // Check if new name already exists (if name changed)
              if (newName !== name && guestExistsAnywhere(newName)) {
                showNotification(
                  "Guest with this name already exists!",
                  "error"
                );
                return;
              }
              // Update data model
              const guestIndex = weddingData.guests.findIndex(
                (g) => g.name === name
              );
              if (guestIndex !== -1) {
                weddingData.guests[guestIndex] = {
                  name: newName,
                  side: newSide,
                  rsvp: newRSVP,
                  invitationSent: newInvitation,
                  saveTheDate: newSaveTheDate,
                };
                saveData();
              }
              // Update the guest element with new values
              guestElement.dataset.name = newName;
              guestElement.dataset.side = newSide;
              guestElement.dataset.rsvp = newRSVP;
              guestElement.querySelector(".guest-name").textContent = newName;
              guestElement.querySelector(".guest-side").textContent = newSide;
              guestElement.querySelector(
                ".guest-side"
              ).className = `guest-side ${newSide.toLowerCase()}`;
              // Update edit button data attribute
              guestElement.querySelector(".edit-guest").dataset.name = newName;
              guestElement.querySelector(".delete-guest").dataset.name =
                newName;
              // Replace form with updated guest element
              editForm.parentNode.replaceChild(guestElement, editForm);
              // Update guest in the table if it exists
              const guestTableRow = guestTableBody.querySelector(
                `.guest-row[data-name="${name}"]`
              );
              if (guestTableRow) {
                guestTableRow.dataset.name = newName;
                guestTableRow.dataset.side = newSide;
                guestTableRow.dataset.rsvp = newRSVP;
                guestTableRow.dataset.invitation = newInvitation;
                guestTableRow.dataset.savethedate = newSaveTheDate;
                const sideClass = newSide.toLowerCase();
                const rsvpClass = newRSVP.toLowerCase();
                guestTableRow.innerHTML = `
                <td>${newName}</td>
                <td><span class="side-badge side-${sideClass}">${newSide}</span></td>
                <td><span class="status-badge status-${rsvpClass}">${newRSVP}</span></td>
                <td>${newInvitation}</td>
                <td>${newSaveTheDate}</td>
                <td>
                  <div class="action-buttons">
                    <button class="edit-guest" data-name="${newName}">
                      <i class="fas fa-edit"></i>
                    </button>
                    <button class="delete-guest" data-name="${newName}">
                      <i class="fas fa-trash"></i>
                    </button>
                  </div>
                </td>
              `;
              }
              showNotification(`Guest "${newName}" updated successfully`);
            });
          // Handle cancel
          document
            .getElementById("cancelGuestEdit")
            .addEventListener("click", () => {
              editForm.parentNode.replaceChild(guestElement, editForm);
            });
        }
      }
      // Function to rebuild tables container from data model
      function rebuildTablesContainer() {
        // Clear the tables container
        tablesContainer.innerHTML = "";
        tables = [];
        // If no tables, show empty state
        if (weddingData.tables.length === 0) {
          tablesContainer.appendChild(emptyTables);
          emptyTables.style.display = "flex";
          return;
        }
        // Rebuild each table
        weddingData.tables.forEach((tableData, index) => {
          // Create a new table element for table view
          const table = document.createElement("div");
          table.className = "table-card";
          table.dataset.tableNumber = index + 1;
          const header = document.createElement("div");
          header.className = "table-header";
          const title = document.createElement("h3");
          title.textContent = tableData.name;
          const count = document.createElement("div");
          count.className = "guest-count";
          count.textContent = tableData.guests ? tableData.guests.length : 0;
          header.appendChild(title);
          header.appendChild(count);
          table.appendChild(header);
          const ul = document.createElement("ul");
          table.appendChild(ul);
          // Add guests to the table
          if (tableData.guests && tableData.guests.length > 0) {
            tableData.guests.forEach((guestName) => {
              // Find guest data
              const guestData = weddingData.guests.find(
                (g) => g.name === guestName
              );
              if (guestData) {
                // Create guest element
                const li = document.createElement("li");
                const displayName =
                  guestData.name.length > 6
                    ? guestData.name.substring(0, 5) + "..."
                    : guestData.name;
                li.textContent = displayName;
                li.draggable = true;
                li.dataset.name = guestData.name;
                li.dataset.fullname = guestData.name;
                li.dataset.side = guestData.side;
                li.dataset.rsvp = guestData.rsvp;
                li.classList.add(
                  guestData.side === "Bride"
                    ? "bride"
                    : guestData.side === "Groom"
                    ? "groom"
                    : "other"
                );
                li.addEventListener("dragstart", (ev) => {
                  ev.dataTransfer.setData(
                    "text/plain",
                    JSON.stringify(guestData)
                  );
                  trashArea.classList.add("active");
                });
                li.addEventListener("dragend", () => {
                  trashArea.classList.remove("active");
                });
                ul.appendChild(li);
              }
            });
          }
          // Add drop event listener
          table.addEventListener("dragover", (e) => {
            e.preventDefault();
            trashArea.classList.remove("active");
          });
          table.addEventListener("drop", (e) => {
            e.preventDefault();
            const data = JSON.parse(e.dataTransfer.getData("text/plain"));
            // Check if table is full
            const currentGuests = ul.querySelectorAll("li").length;
            if (currentGuests >= 12) {
              showNotification(
                "Table capacity reached (12 guests max)",
                "error"
              );
              return;
            }
            // Remove from guest list or other tables
            const sourceElements = [
              ...document.querySelectorAll(".guest-item, .table-card ul li"),
            ];
            sourceElements.forEach((el) => {
              if (el.dataset.name === data.name) {
                el.remove();
              }
            });
            // Create guest element
            const li = document.createElement("li");
            const displayName =
              data.name.length > 6
                ? data.name.substring(0, 5) + "..."
                : data.name;
            li.textContent = displayName;
            li.draggable = true;
            li.dataset.name = data.name;
            li.dataset.fullname = data.name;
            li.dataset.side = data.side;
            li.dataset.rsvp = data.rsvp;
            li.classList.add(
              data.side === "Bride"
                ? "bride"
                : data.side === "Groom"
                ? "groom"
                : "other"
            );
            li.addEventListener("dragstart", (ev) => {
              ev.dataTransfer.setData("text/plain", JSON.stringify(data));
              trashArea.classList.add("active");
            });
            li.addEventListener("dragend", () => {
              trashArea.classList.remove("active");
            });
            ul.appendChild(li);
            // Update data model
            const tableName = title.textContent;
            const tableIndex = weddingData.tables.findIndex(
              (t) => t.name === tableName
            );
            if (tableIndex !== -1) {
              if (!weddingData.tables[tableIndex].guests) {
                weddingData.tables[tableIndex].guests = [];
              }
              weddingData.tables[tableIndex].guests.push(data.name);
              saveData();
            }
            updateGuestCount();
            showNotification(`${data.name} seated at ${title.textContent}`);
          });
          tablesContainer.appendChild(table);
          tables.push(table);
        });
        updateGuestCount();
      }
      // Create table function
      function createTable(num, name = "", saveToData = true) {
        const table = document.createElement("div");
        table.className = "table-card";
        table.dataset.tableNumber = num;
        const header = document.createElement("div");
        header.className = "table-header";
        const title = document.createElement("h3");
        title.textContent = name || "Table " + num;
        const count = document.createElement("div");
        count.className = "guest-count";
        count.textContent = "0";
        header.appendChild(title);
        header.appendChild(count);
        table.appendChild(header);
        const ul = document.createElement("ul");
        table.appendChild(ul);
        table.addEventListener("dragover", (e) => {
          e.preventDefault();
          trashArea.classList.remove("active");
        });
        table.addEventListener("drop", (e) => {
          e.preventDefault();
          const data = JSON.parse(e.dataTransfer.getData("text/plain"));
          // Check if table is full
          const currentGuests = ul.querySelectorAll("li").length;
          if (currentGuests >= 12) {
            showNotification("Table capacity reached (12 guests max)", "error");
            return;
          }
          // Remove from guest list or other tables
          const sourceElements = [
            ...document.querySelectorAll(".guest-item, .table-card ul li"),
          ];
          sourceElements.forEach((el) => {
            if (el.dataset.name === data.name) {
              el.remove();
            }
          });
          // Create guest element
          const li = document.createElement("li");
          // Truncate long names to fit in circle
          const displayName =
            data.name.length > 6
              ? data.name.substring(0, 5) + "..."
              : data.name;
          li.textContent = displayName;
          li.draggable = true;
          li.dataset.name = data.name;
          li.dataset.fullname = data.name;
          li.dataset.side = data.side;
          li.dataset.rsvp = data.rsvp;
          li.classList.add(
            data.side === "Bride"
              ? "bride"
              : data.side === "Groom"
              ? "groom"
              : "other"
          );
          li.addEventListener("dragstart", (ev) => {
            ev.dataTransfer.setData("text/plain", JSON.stringify(data));
            trashArea.classList.add("active");
          });
          li.addEventListener("dragend", () => {
            trashArea.classList.remove("active");
          });
          ul.appendChild(li);
          // Update data model
          const tableName = title.textContent;
          const tableIndex = weddingData.tables.findIndex(
            (t) => t.name === tableName
          );
          if (tableIndex !== -1) {
            if (!weddingData.tables[tableIndex].guests) {
              weddingData.tables[tableIndex].guests = [];
            }
            weddingData.tables[tableIndex].guests.push(data.name);
            saveData();
          }
          updateGuestCount();
          showNotification(`${data.name} seated at ${title.textContent}`);
        });
        tablesContainer.appendChild(table);
        tables.push(table);
        // Add to data model
        if (saveToData) {
          weddingData.tables.push({
            name: name || "Table " + num,
            guests: [],
          });
          saveData();
        }
        // Initialize position for floor plan with calculated position
        const position = calculateNewTablePosition();
        tablePositions[title.textContent] = position;
        weddingData.tablePositions = tablePositions;
        saveData();
        // Hide empty state if visible
        emptyTables.style.display = "none";
        showNotification(`Table "${title.textContent}" created`);
      }
      // Update guest count for tables
      function updateGuestCount() {
        tables.forEach((table) => {
          const count = table.querySelector("ul").querySelectorAll("li").length;
          const countElement = table.querySelector(".guest-count");
          countElement.textContent = count;
          // Update capacity indicator
          const capacity = 12; // Maximum guests per table
          const percentage = (count / capacity) * 100;
          // Remove existing capacity classes
          table.classList.remove(
            "low-capacity",
            "medium-capacity",
            "high-capacity",
            "full-capacity"
          );
          // Add appropriate capacity class
          if (percentage === 0) {
            // No capacity class needed
          } else if (percentage < 50) {
            table.classList.add("low-capacity");
          } else if (percentage < 80) {
            table.classList.add("medium-capacity");
          } else if (percentage < 100) {
            table.classList.add("high-capacity");
          } else {
            table.classList.add("full-capacity");
          }
        });
      }
      // Event listeners
      addGuestBtn.addEventListener("click", addGuest);
      guestNameInput.addEventListener("keypress", (e) => {
        if (e.key === "Enter") addGuest();
      });
      addTableBtn.addEventListener("click", () => {
        const tableName = tableNameInput.value.trim();
        createTable(tables.length + 1, tableName);
        tableNameInput.value = "";
      });
      // Edit guest from table
      document.addEventListener("click", (e) => {
        if (e.target.closest(".guest-row .edit-guest")) {
          const btn = e.target.closest(".edit-guest");
          const guestRow = btn.closest(".guest-row");
          editGuest(guestRow, true);
        }
        // Edit guest from list
        if (e.target.closest(".guest-item .edit-guest")) {
          const btn = e.target.closest(".edit-guest");
          const guestItem = btn.closest(".guest-item");
          editGuest(guestItem, false);
        }
      });
      // Delete guest from table
      document.addEventListener("click", (e) => {
        if (e.target.closest(".guest-row .delete-guest")) {
          const btn = e.target.closest(".delete-guest");
          const name = btn.dataset.name;
          const row = btn.closest(".guest-row");
          if (confirm(`Remove ${name} from guest list?`)) {
            // Remove from data model
            weddingData.guests = weddingData.guests.filter(
              (g) => g.name !== name
            );
            // Remove from tables
            weddingData.tables.forEach((table) => {
              if (table.guests) {
                table.guests = table.guests.filter((g) => g !== name);
              }
            });
            saveData();
            // Remove from table
            row.remove();
            // Remove from guest list if it exists
            const guestItem = guestList.querySelector(
              `.guest-item[data-name="${name}"]`
            );
            if (guestItem) {
              guestItem.remove();
            }
            // Remove from any tables if seated
            const tableGuests = document.querySelectorAll(
              `.table-card ul li[data-name="${name}"]`
            );
            tableGuests.forEach((guest) => guest.remove());
            updateGuestCount();
            showNotification(`${name} removed from guest list`);
            // Show empty state if no guests
            if (
              guestTableBody.children.length === 1 &&
              guestTableBody.children[0] === emptyGuestRow
            ) {
              emptyGuestRow.style.display = "table-row";
            }
            if (
              guestList.children.length === 1 &&
              guestList.children[0] === emptyGuestList
            ) {
              emptyGuestList.style.display = "flex";
            }
          }
        }
        // Delete guest from list
        if (e.target.closest(".guest-item .delete-guest")) {
          const btn = e.target.closest(".delete-guest");
          const name = btn.dataset.name;
          const item = btn.closest(".guest-item");
          if (confirm(`Remove ${name} from guest list?`)) {
            // Remove from data model
            weddingData.guests = weddingData.guests.filter(
              (g) => g.name !== name
            );
            // Remove from tables
            weddingData.tables.forEach((table) => {
              if (table.guests) {
                table.guests = table.guests.filter((g) => g !== name);
              }
            });
            saveData();
            // Remove from list
            item.remove();
            // Remove from table if it exists
            const guestRow = guestTableBody.querySelector(
              `.guest-row[data-name="${name}"]`
            );
            if (guestRow) {
              guestRow.remove();
            }
            // Remove from any tables if seated
            const tableGuests = document.querySelectorAll(
              `.table-card ul li[data-name="${name}"]`
            );
            tableGuests.forEach((guest) => guest.remove());
            updateGuestCount();
            showNotification(`${name} removed from guest list`);
            // Show empty state if no guests
            if (
              guestTableBody.children.length === 1 &&
              guestTableBody.children[0] === emptyGuestRow
            ) {
              emptyGuestRow.style.display = "table-row";
            }
            if (
              guestList.children.length === 1 &&
              guestList.children[0] === emptyGuestList
            ) {
              emptyGuestList.style.display = "flex";
            }
          }
        }
      });
      // Search guests
      searchGuestsInput.addEventListener("input", (e) => {
        const searchTerm = e.target.value.toLowerCase();
        const guestItems = guestList.querySelectorAll(".guest-item");
        guestItems.forEach((item) => {
          const name = item.dataset.name.toLowerCase();
          const side = item.dataset.side.toLowerCase();
          if (name.includes(searchTerm) || side.includes(searchTerm)) {
            item.style.display = "flex";
          } else {
            item.style.display = "none";
          }
        });
      });
      // Export PDF
      exportPDFBtn.addEventListener("click", () => {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        let y = 20;
        doc.setFont("Playfair Display", "normal");
        doc.setFontSize(22);
        doc.text("Wedding Seating Chart", 105, y, { align: "center" });
        y += 15;
        doc.setFont("Inter", "normal");
        doc.setFontSize(12);
        doc.text(`Generated on: ${new Date().toLocaleDateString()}`, 105, y, {
          align: "center",
        });
        y += 15;
        // Add guest list
        doc.setFont("Playfair Display", "normal");
        doc.setFontSize(16);
        doc.text("Guest List", 20, y);
        y += 10;
        // Table headers
        doc.setFont("Inter", "normal");
        doc.setFontSize(10);
        doc.text("Name", 20, y);
        doc.text("Side", 80, y);
        doc.text("RSVP", 110, y);
        doc.text("Invitation", 140, y);
        doc.text("Save the Date", 170, y);
        y += 5;
        // Guest list rows
        const guestRows = guestTableBody.querySelectorAll(".guest-row");
        guestRows.forEach((row) => {
          if (y > 270) {
            doc.addPage();
            y = 20;
          }
          const name = row.dataset.name;
          const side = row.dataset.side;
          const rsvp = row.dataset.rsvp;
          const invitation = row.dataset.invitation;
          const saveTheDate = row.dataset.savethedate;
          doc.text(name, 20, y);
          doc.text(side, 80, y);
          doc.text(rsvp, 110, y);
          doc.text(invitation, 140, y);
          doc.text(saveTheDate, 170, y);
          y += 5;
        });
        y += 10;
        // Add unassigned guests
        const unassigned = Array.from(
          guestList.querySelectorAll(".guest-item")
        );
        if (unassigned.length > 0) {
          if (y > 250) {
            doc.addPage();
            y = 20;
          }
          doc.setFont("Playfair Display", "normal");
          doc.setFontSize(16);
          doc.text("Unassigned Guests", 20, y);
          y += 8;
          doc.setFont("Inter", "normal");
          doc.setFontSize(12);
          unassigned.forEach((item) => {
            if (y > 270) {
              doc.addPage();
              y = 20;
            }
            doc.text(
              `- ${item.dataset.name} (${item.dataset.side}, ${item.dataset.rsvp})`,
              25,
              y
            );
            y += 6;
          });
          y += 10;
        }
        if (tables.length === 0) {
          if (y > 250) {
            doc.addPage();
            y = 20;
          }
          doc.setFontSize(14);
          doc.text("No tables created yet.", 105, y, { align: "center" });
        } else {
          tables.forEach((table) => {
            if (y > 250) {
              doc.addPage();
              y = 20;
            }
            const tableName = table.querySelector("h3").textContent;
            const guests = table.querySelectorAll("li");
            doc.setFont("Playfair Display", "normal");
            doc.setFontSize(16);
            doc.text(tableName, 20, y);
            y += 8;
            doc.setFont("Inter", "normal");
            doc.setFontSize(12);
            doc.text(`Guests: ${guests.length}`, 20, y);
            y += 8;
            guests.forEach((g) => {
              if (y > 270) {
                doc.addPage();
                y = 20;
              }
              doc.text(
                `- ${g.dataset.fullname} (${g.dataset.side}, ${g.dataset.rsvp})`,
                25,
                y
              );
              y += 6;
            });
            y += 10;
          });
        }
        doc.save("Wedding-Seating-Chart.pdf");
        showNotification("Seating chart exported successfully");
      });
      // Generate Place Cards
      generatePlaceCardsBtn.addEventListener("click", () => {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        // Set up page dimensions
        const pageWidth = doc.internal.pageSize.width;
        const pageHeight = doc.internal.pageSize.height;
        // Place card dimensions
        const cardWidth = 90;
        const cardHeight = 50;
        const margin = 15;
        // Track position
        let x = margin;
        let y = margin;
        let cardCount = 0;
        // Add title
        doc.setFont("Playfair Display", "normal");
        doc.setFontSize(18);
        doc.text("Wedding Place Cards", pageWidth / 2, 10, { align: "center" });
        // Generate place cards for all seated guests
        tables.forEach((table) => {
          const tableName = table.querySelector("h3").textContent;
          const guests = table.querySelectorAll("li");
          guests.forEach((guest) => {
            // Check if we need a new page
            if (y + cardHeight > pageHeight - margin) {
              doc.addPage();
              y = margin;
            }
            // Draw card border
            doc.setDrawColor(212, 165, 165);
            doc.setLineWidth(0.5);
            doc.rect(x, y, cardWidth, cardHeight);
            // Add guest name
            doc.setFont("Playfair Display", "normal");
            doc.setFontSize(14);
            doc.text(guest.dataset.fullname, x + cardWidth / 2, y + 20, {
              align: "center",
            });
            // Add table name
            doc.setFont("Inter", "normal");
            doc.setFontSize(10);
            doc.text(`Table: ${tableName}`, x + cardWidth / 2, y + 35, {
              align: "center",
            });
            // Update position
            x += cardWidth + margin;
            cardCount++;
            // Move to next row if needed
            if (x + cardWidth > pageWidth - margin) {
              x = margin;
              y += cardHeight + margin;
            }
          });
        });
        if (cardCount === 0) {
          doc.setFontSize(14);
          doc.text("No seated guests found.", pageWidth / 2, pageHeight / 2, {
            align: "center",
          });
        }
        doc.save("Wedding-Place-Cards.pdf");
        showNotification("Place cards generated successfully");
      });
      // Reset all data
      resetAllBtn.addEventListener("click", () => {
        if (
          confirm(
            "Are you sure you want to reset all data? This cannot be undone."
          )
        ) {
          // Clear data model
          weddingData = {
            guests: [],
            tables: [],
            tablePositions: {},
          };
          saveData();
          // Clear guest list
          guestList.innerHTML = "";
          guestList.appendChild(emptyGuestList);
          emptyGuestList.style.display = "flex";
          // Clear guest table
          guestTableBody.innerHTML = "";
          guestTableBody.appendChild(emptyGuestRow);
          emptyGuestRow.style.display = "table-row";
          // Clear tables
          tablesContainer.innerHTML = "";
          tables = [];
          tablePositions = {};
          tablesContainer.appendChild(emptyTables);
          emptyTables.style.display = "flex";
          // Clear inputs
          guestNameInput.value = "";
          tableNameInput.value = "";
          searchGuestsInput.value = "";
          // Reset view to table view
          currentView = "table";
          tableViewBtn.classList.add("active");
          floorPlanViewBtn.classList.remove("active");
          showNotification("All data has been reset");
        }
      });
      // Trash area functionality
      trashArea.addEventListener("dragover", (e) => {
        e.preventDefault();
        trashArea.classList.add("active");
      });
      trashArea.addEventListener("dragleave", () => {
        trashArea.classList.remove("active");
      });
      trashArea.addEventListener("drop", (e) => {
        e.preventDefault();
        const data = JSON.parse(e.dataTransfer.getData("text/plain"));
        // Find and remove the guest
        const sourceElements = [
          ...document.querySelectorAll(".guest-item, .table-card ul li"),
        ];
        sourceElements.forEach((el) => {
          if (el.dataset.name === data.name) {
            el.remove();
          }
        });
        // Remove from data model
        weddingData.guests = weddingData.guests.filter(
          (g) => g.name !== data.name
        );
        // Remove from tables
        weddingData.tables.forEach((table) => {
          if (table.guests) {
            table.guests = table.guests.filter((g) => g !== data.name);
          }
        });
        saveData();
        // Also remove from guest table if exists
        const guestRow = guestTableBody.querySelector(
          `.guest-row[data-name="${data.name}"]`
        );
        if (guestRow) {
          guestRow.remove();
          // Show empty state if no guests
          if (
            guestTableBody.children.length === 1 &&
            guestTableBody.children[0] === emptyGuestRow
          ) {
            emptyGuestRow.style.display = "table-row";
          }
        }
        updateGuestCount();
        trashArea.classList.remove("active");
        showNotification(`${data.name} has been removed`);
      });
      // View toggle functionality
      tableViewBtn.addEventListener("click", () => {
        if (currentView === "table") return;
        currentView = "table";
        tableViewBtn.classList.add("active");
        floorPlanViewBtn.classList.remove("active");
        // Restore tables container
        const rightPanel = document.querySelector(".right-panel .panel");
        const floorPlan = rightPanel.querySelector(".floor-plan");
        if (floorPlan) {
          rightPanel.replaceChild(tablesContainer, floorPlan);
          // Rebuild the tables container from the data model
          rebuildTablesContainer();
        }
        showNotification("Switched to table view");
      });
      floorPlanViewBtn.addEventListener("click", () => {
        if (currentView === "floorPlan") return;
        currentView = "floorPlan";
        floorPlanViewBtn.classList.add("active");
        tableViewBtn.classList.remove("active");
        // Create floor plan container
        const floorPlan = document.createElement("div");
        floorPlan.className = "floor-plan";
        // Add instructions
        const instructions = document.createElement("div");
        instructions.className = "floor-plan-instructions";
        instructions.innerHTML =
          '<i class="fas fa-info-circle"></i> Drag tables to reposition them';
        floorPlan.appendChild(instructions);
        // Add venue outline
        const venue = document.createElement("div");
        venue.style.position = "absolute";
        venue.style.top = "20px";
        venue.style.left = "20px";
        venue.style.right = "20px";
        venue.style.bottom = "20px";
        venue.style.border = "2px dashed #d4a5a5";
        venue.style.borderRadius = "10px";
        floorPlan.appendChild(venue);
        // Add stage area
        const stage = document.createElement("div");
        stage.style.position = "absolute";
        stage.style.top = "20px";
        stage.style.left = "50%";
        stage.style.transform = "translateX(-50%)";
        stage.style.width = "200px";
        stage.style.height = "40px";
        stage.style.backgroundColor = "#d4a5a5";
        stage.style.borderRadius = "20px";
        stage.style.display = "flex";
        stage.style.alignItems = "center";
        stage.style.justifyContent = "center";
        stage.style.color = "white";
        stage.style.fontWeight = "bold";
        stage.textContent = "Stage";
        venue.appendChild(stage);
        // Add tables to floor plan
        tables.forEach((table, index) => {
          const tableName = table.querySelector("h3").textContent;
          const guestCount = table.querySelector(".guest-count").textContent;
          // Get saved position or use default
          const position = tablePositions[tableName] || { top: 100, left: 50 };
          const tableElement = document.createElement("div");
          tableElement.className = "floor-plan-table";
          tableElement.style.position = "absolute";
          tableElement.style.top = `${position.top}px`;
          tableElement.style.left = `${position.left}px`;
          tableElement.dataset.tableName = tableName;
          // Add table content
          tableElement.innerHTML = `
            <div class="floor-plan-table-name">${tableName}</div>
            <div class="floor-plan-table-count">${guestCount}/12</div>
          `;
          // Add delete button
          const deleteBtn = document.createElement("button");
          deleteBtn.className = "floor-plan-delete-table";
          deleteBtn.innerHTML = '<i class="fas fa-times"></i>';
          deleteBtn.addEventListener("click", () => {
            if (confirm(`Are you sure you want to delete ${tableName}?`)) {
              // Remove from data model
              const tableIndex = weddingData.tables.findIndex(
                (t) => t.name === tableName
              );
              if (tableIndex !== -1) {
                weddingData.tables.splice(tableIndex, 1);
                delete weddingData.tablePositions[tableName];
                saveData();
                // Renumber tables after deletion
                renumberTables();
              }
              // Remove from tables array
              tables = tables.filter(
                (t) => t.querySelector("h3").textContent !== tableName
              );
              tableElement.remove();
              showNotification(`Table "${tableName}" deleted`);
              // Show empty state if no tables
              if (document.querySelectorAll(".floor-plan-table").length === 0) {
                const emptyState = document.createElement("div");
                emptyState.className = "empty-state";
                emptyState.style.position = "absolute";
                emptyState.style.top = "50%";
                emptyState.style.left = "50%";
                emptyState.style.transform = "translate(-50%, -50%)";
                emptyState.innerHTML = `
                  <i class="fas fa-chair"></i>
                  <p>No tables created yet. Add your first table to get started!</p>
                `;
                venue.appendChild(emptyState);
              }
            }
          });
          tableElement.appendChild(deleteBtn);
          // Make table draggable
          let isDragging = false;
          let startX, startY, initialLeft, initialTop;
          tableElement.addEventListener("mousedown", (e) => {
            // Don't start dragging if clicking on delete button
            if (e.target.closest(".floor-plan-delete-table")) return;
            isDragging = true;
            tableElement.classList.add("dragging");
            startX = e.clientX;
            startY = e.clientY;
            initialLeft = parseInt(tableElement.style.left);
            initialTop = parseInt(tableElement.style.top);
            e.preventDefault();
          });
          document.addEventListener("mousemove", (e) => {
            if (!isDragging) return;
            const dx = e.clientX - startX;
            const dy = e.clientY - startY;
            let newLeft = initialLeft + dx;
            let newTop = initialTop + dy;
            // Boundary constraints
            const venueRect = venue.getBoundingClientRect();
            const tableRect = tableElement.getBoundingClientRect();
            const floorPlanRect = floorPlan.getBoundingClientRect();
            // Convert to relative position
            const venueLeft = venueRect.left - floorPlanRect.left;
            const venueTop = venueRect.top - floorPlanRect.top;
            const venueRight = venueLeft + venueRect.width;
            const venueBottom = venueTop + venueRect.height;
            // Keep table within venue boundaries
            newLeft = Math.max(
              venueLeft,
              Math.min(newLeft, venueRight - tableRect.width)
            );
            newTop = Math.max(
              venueTop,
              Math.min(newTop, venueBottom - tableRect.height)
            );
            tableElement.style.left = `${newLeft}px`;
            tableElement.style.top = `${newTop}px`;
          });
          document.addEventListener("mouseup", () => {
            if (isDragging) {
              isDragging = false;
              tableElement.classList.remove("dragging");
              // Save the new position
              tablePositions[tableName] = {
                left: parseInt(tableElement.style.left),
                top: parseInt(tableElement.style.top),
              };
              weddingData.tablePositions = tablePositions;
              saveData();
            }
          });
          venue.appendChild(tableElement);
        });
        // Replace tables container with floor plan
        const rightPanel = document.querySelector(".right-panel .panel");
        rightPanel.replaceChild(floorPlan, tablesContainer);
        showNotification(
          "Switched to floor plan view. Drag tables to reposition them."
        );
      });
      // Initialize empty states
      emptyGuestList.style.display = "flex";
      emptyGuestRow.style.display = "table-row";
      emptyTables.style.display = "flex";
    </script>
  </body>
</html>

